(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37d645f6"],{"0c3e":function(t,e,n){},"333d":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[n("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},i=[];n("c5f6");Math.easeInOutQuad=function(t,e,n,a){return t/=a/2,t<1?n/2*t*t+e:(t--,-n/2*(t*(t-2)-1)+e)};var l=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function o(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(t,e,n){var a=s(),i=t-a,r=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=r;var s=Math.easeInOutQuad(c,a,i,e);o(s),c<e?l(t):n&&"function"===typeof n&&n()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},page_size:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.page_size},set:function(t){this.$emit("update:page_size",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,page_size:t}),this.autoScroll&&r(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,page_size:this.pageSize}),this.autoScroll&&r(0,800)}}},u=c,d=(n("36ff"),n("2877")),m=Object(d["a"])(u,a,i,!1,null,"16564f64",null);e["a"]=m.exports},"36ff":function(t,e,n){"use strict";var a=n("0c3e"),i=n.n(a);i.a},"383f":function(t,e,n){"use strict";n.d(e,"m",function(){return i}),n.d(e,"q",function(){return l}),n.d(e,"e",function(){return o}),n.d(e,"a",function(){return s}),n.d(e,"d",function(){return r}),n.d(e,"b",function(){return c}),n.d(e,"s",function(){return u}),n.d(e,"w",function(){return d}),n.d(e,"r",function(){return m}),n.d(e,"y",function(){return f}),n.d(e,"z",function(){return p}),n.d(e,"x",function(){return g}),n.d(e,"o",function(){return h}),n.d(e,"A",function(){return _}),n.d(e,"c",function(){return y}),n.d(e,"p",function(){return b}),n.d(e,"n",function(){return v}),n.d(e,"t",function(){return k}),n.d(e,"v",function(){return w}),n.d(e,"u",function(){return S}),n.d(e,"j",function(){return j}),n.d(e,"f",function(){return x}),n.d(e,"k",function(){return C}),n.d(e,"g",function(){return O}),n.d(e,"i",function(){return L}),n.d(e,"h",function(){return z}),n.d(e,"l",function(){return T});var a=n("b775");function i(t){return Object(a["a"])({url:"/saltstack/salt-minion/1/",method:"get",params:t})}function l(t){return Object(a["a"])({url:"/saltstack/salt-key/",method:"get",params:t})}function o(){return Object(a["a"])({url:"/saltstack/salt-key/",method:"post",data:{salt_key_tag:"global_flush_salt_key"}})}function s(t){return Object(a["a"])({url:"/saltstack/salt-key-opt/accept/",method:"post",data:{salt_key_tag:"accept_salt_key",minion_id:t}})}function r(t){return Object(a["a"])({url:"/saltstack/salt-key-opt/delete/",method:"post",data:{salt_key_tag:"delete_salt_key",minion_id:t}})}function c(t){return Object(a["a"])({url:"/saltstack/salt-key-opt/del-denied/",method:"post",data:{salt_key_tag:"delete_denied_salt_key",minion_id:t}})}function u(t){return Object(a["a"])({url:"/saltstack/salt-key-opt/reject/",method:"post",data:{salt_key_tag:"reject_salt_key",minion_id:t}})}function d(t){return Object(a["a"])({url:"/saltstack/salt-key/"+t+"/",method:"get"})}function m(t){return Object(a["a"])({url:"/saltstack/salt-minion/",method:"get",params:t})}function f(){return Object(a["a"])({url:"/saltstack/salt-minion/",method:"post",data:{salt_minion_tag:"global_update_salt_minion_list"}})}function p(){return Object(a["a"])({url:"/saltstack/salt-minion-opt/status-update/",method:"post",data:{salt_minion_tag:"global_update_salt_minion_status"}})}function g(t){return Object(a["a"])({url:"/saltstack/salt-minion-opt/update/",method:"post",data:{salt_minion_tag:"update_salt_minion",minion_id:t}})}function h(t){return Object(a["a"])({url:"/saltstack/salt-cmd/",method:"get",params:t})}function _(t){return Object(a["a"])({url:"/saltstack/salt-cmd/",method:"post",data:{salt_cmd_tag:"collection_info",collection_style:t.collection_style,minions:t.minions}})}function y(){return Object(a["a"])({url:"/saltstack/salt-cmd-opt/delete/",method:"post",data:{salt_cmd_tag:"salt_cmd_delete"}})}function b(t){return Object(a["a"])({url:"/saltstack/salt-cmd-opt/get-module/",method:"get",params:{salt_cmd_type:t}})}function v(t,e){return Object(a["a"])({url:"/saltstack/salt-cmd-opt/get-cmd/",method:"get",params:{salt_cmd_type:t,salt_cmd_module:e}})}function k(t){return Object(a["a"])({url:"/saltstack/salt-exe/",method:"post",data:t})}function w(t){return Object(a["a"])({url:"/saltstack/salt-tool/job-search/status/",method:"post",data:t})}function S(t){return Object(a["a"])({url:"/saltstack/salt-tool/job-search/result/",method:"post",data:t})}function j(t){return Object(a["a"])({url:"/saltstack/file-manage/file-tree/",method:"post",data:t})}function x(t){return Object(a["a"])({url:"/saltstack/file-manage/file-content/",method:"post",data:t})}function C(t){return Object(a["a"])({url:"/saltstack/file-manage/file-update/",method:"post",data:t})}function O(t){return Object(a["a"])({url:"/saltstack/file-manage/file-create/",method:"post",data:t})}function L(t){return Object(a["a"])({url:"/saltstack/file-manage/file-rename/",method:"post",data:t})}function z(t){return Object(a["a"])({url:"/saltstack/file-manage/file-delete/",method:"post",data:t})}function T(t){return Object(a["a"])({url:"/saltstack/file-manage/file-upload/",method:"post",data:t})}},"5c83":function(t,e,n){"use strict";n("a481"),n("6762"),n("2fdb");var a={bind:function(t,e,n){var a=t.querySelector(".el-dialog__header"),i=t.querySelector(".el-dialog");a.style.cssText+=";cursor:move;",i.style.cssText+=";top:0px;";var l=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();a.onmousedown=function(t){var e=t.clientX-a.offsetLeft,o=t.clientY-a.offsetTop,s=i.offsetWidth,r=i.offsetHeight,c=document.body.clientWidth,u=document.body.clientHeight,d=i.offsetLeft,m=c-i.offsetLeft-s,f=i.offsetTop,p=u-i.offsetTop-r,g=l(i,"left"),h=l(i,"top");g.includes("%")?(g=+document.body.clientWidth*(+g.replace(/\%/g,"")/100),h=+document.body.clientHeight*(+h.replace(/\%/g,"")/100)):(g=+g.replace(/\px/g,""),h=+h.replace(/\px/g,"")),document.onmousemove=function(t){var a=t.clientX-e,l=t.clientY-o;-a>d?a=-d:a>m&&(a=m),-l>f?l=-f:l>p&&(l=p),i.style.cssText+=";left:".concat(a+g,"px;top:").concat(l+h,"px;"),n.child.$emit("dragDialog")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}},i=function(t){t.directive("el-drag-dialog",a)};window.Vue&&(window["el-drag-dialog"]=a,Vue.use(i)),a.install=i;e["a"]=a},6724:function(t,e,n){"use strict";n("8d41");var a="@@wavesContext";function i(t,e){function n(n){var a=Object.assign({},e.value),i=Object.assign({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),l=i.ele;if(l){l.style.position="relative",l.style.overflow="hidden";var o=l.getBoundingClientRect(),s=l.querySelector(".waves-ripple");switch(s?s.className="waves-ripple":(s=document.createElement("span"),s.className="waves-ripple",s.style.height=s.style.width=Math.max(o.width,o.height)+"px",l.appendChild(s)),i.type){case"center":s.style.top=o.height/2-s.offsetHeight/2+"px",s.style.left=o.width/2-s.offsetWidth/2+"px";break;default:s.style.top=(n.pageY-o.top-s.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",s.style.left=(n.pageX-o.left-s.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return s.style.backgroundColor=i.color,s.className="waves-ripple z-active",!1}}return t[a]?t[a].removeHandle=n:t[a]={removeHandle:n},n}var l={bind:function(t,e){t.addEventListener("click",i(t,e),!1)},update:function(t,e){t.removeEventListener("click",t[a].removeHandle,!1),t.addEventListener("click",i(t,e),!1)},unbind:function(t){t.removeEventListener("click",t[a].removeHandle,!1),t[a]=null,delete t[a]}},o=function(t){t.directive("waves",l)};window.Vue&&(window.waves=l,Vue.use(o)),l.install=o;e["a"]=l},"76c6":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.allLoading,expression:"allLoading"}],staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-row",{staticClass:"saltminion_global"},[n("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"small"},on:{click:t.handleupdateSaltCmdListDailog}},[t._v("命令采集")]),t._v(" "),n("el-button",{staticClass:"filter-item",attrs:{type:"danger",size:"small"},on:{click:t.handleDeleteSaltCmdList}},[t._v("清空命令")]),t._v(" "),n("div",{staticStyle:{float:"right"}},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"命令"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.search,callback:function(e){t.$set(t.listQuery,"search",e)},expression:"listQuery.search"}}),t._v(" "),n("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},attrs:{clearable:"",placeholder:"命令类型"},on:{change:t.handleFilter},model:{value:t.listQuery.salt_cmd_type,callback:function(e){t.$set(t.listQuery,"salt_cmd_type",e)},expression:"listQuery.salt_cmd_type"}},[n("el-option",{attrs:{label:"module",value:"module"}}),t._v(" "),n("el-option",{attrs:{label:"state",value:"state"}}),t._v(" "),n("el-option",{attrs:{label:"runner",value:"runner"}})],1),t._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("搜索")])],1)],1)],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.data_list,border:"",fit:"","highlight-current-row":""},on:{"sort-change":t.sortChange,"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{label:"命令类型",prop:"salt_cmd_type",sortable:"custom",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.salt_cmd_type))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"模块",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.salt_cmd_module))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"命令",prop:"salt_cmd",sortable:"custom",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"link-type",on:{click:function(n){return t.handleSaltCmdInfo(e.row)}}},[t._v(t._s(e.row.salt_cmd))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"来源",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.salt_cmd_source))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"最近一次采集时间",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("parseTime")(e.row.update_time,"{y}-{m}-{d} {h}:{i}")))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center","min-width":"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return t.handleSaltCmdInfo(e.row)}}},[t._v("详情")])]}}])})],1),t._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,page_size:t.listQuery.page_size},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:page_size":function(e){return t.$set(t.listQuery,"page_size",e)},pagination:t.getList}}),t._v(" "),n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"采集选项",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("el-scrollbar",{staticStyle:{height:"100%"}},[n("el-form",{ref:"dataForm",staticStyle:{width:"800px","margin-left":"50px"},attrs:{model:t.temp,"label-position":"right","label-width":"130px"}},[n("el-form-item",{staticClass:"is-required",attrs:{label:"命令类型:",prop:"collection_style"}},[n("el-radio-group",{model:{value:t.temp.collection_style,callback:function(e){t.$set(t.temp,"collection_style",e)},expression:"temp.collection_style"}},[n("el-radio",{attrs:{label:"module",border:""}},[t._v("module")]),t._v(" "),n("el-radio",{attrs:{label:"state",border:""}},[t._v("state")]),t._v(" "),n("el-radio",{attrs:{label:"runner",border:""}},[t._v("runner")])],1)],1),t._v(" "),n("el-form-item",{staticClass:"is-required",attrs:{label:"Minion id:",prop:"minion_list",error:t.minion_transfer_error}},[n("el-transfer",{ref:"dataTransfer",attrs:{filterable:"","filter-placeholder":"搜索Minion ID",titles:["Minion ID选择","已选Minion ID"],data:t.minion_list,"target-order":"push"},model:{value:t.temp.minion_list,callback:function(e){t.$set(t.temp,"minion_list",e)},expression:"temp.minion_list"}})],1)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("关闭")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.handleupdateSaltCmdList}},[t._v("确 定")])],1)],1),t._v(" "),n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{visible:t.dialogInfoVisible,title:t.infoTemp.salt_cmd,width:"40%"},on:{"update:visible":function(e){t.dialogInfoVisible=e}}},[n("el-input",{staticClass:"saltcmd-info-textarea",attrs:{type:"textarea",autosize:{minRows:8,maxRows:25},readonly:""},model:{value:t.infoTemp.salt_cmd_doc,callback:function(e){t.$set(t.infoTemp,"salt_cmd_doc",e)},expression:"infoTemp.salt_cmd_doc"}}),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogInfoVisible=!1}}},[t._v("确定")])],1)],1)],1)},i=[],l=(n("ac6a"),n("5c83")),o=n("383f"),s=n("6724"),r=(n("ed08"),n("333d")),c=n("5c96"),u={name:"SaltCmdTable",components:{Pagination:r["a"]},directives:{elDragDialog:l["a"],waves:s["a"]},data:function(){return{listQuery:{page:1,page_size:10,salt_cmd_type:"",ordering:""},allLoading:!1,tableKey:0,data_list:null,total:0,multipleSelection:[],listLoading:!0,minion_list:[],temp:{minion_list:[],collection_style:"module"},dialogFormVisible:!1,dialogInfoVisible:!1,infoTemp:{},minion_transfer_error:""}},watch:{"temp.minion_list":{handler:function(t,e){t.length>0&&(this.minion_transfer_error="")}}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,Object(o["o"])(this.listQuery).then(function(e){t.data_list=e.data.results,t.total=e.data.count,setTimeout(function(){t.listLoading=!1},500)}).catch(function(t){console.log("获取salt命令集列表"+t)})},getListNoloading:function(){var t=this;Object(o["o"])(this.listQuery).then(function(e){t.data_list=e.data.results,t.total=e.data.count}).catch(function(t){console.log("获取salt命令集列表无loading"+t)})},getIdList:function(){var t=this;Object(o["m"])().then(function(e){var n=e.data.results;n.forEach(function(e,n){t.minion_list.push({label:e,key:e})})}).catch(function(t){console.log("获取minion id字段列表"+t)})},handleFilter:function(){this.listQuery.page=1,this.getList()},resetTemp:function(){this.minion_list=[],this.temp={minion_list:[],collection_style:"module"}},handleupdateSaltCmdListDailog:function(){var t=this;this.resetTemp(),this.getIdList(),this.minion_transfer_error="",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataTransfer.clearQuery("left"),t.$refs.dataTransfer.clearQuery("right")})},handleupdateSaltCmdList:function(){var t=this;if(!this.temp.minion_list.length)return this.minion_transfer_error="请至少选择一个Minion ID",!1;this.minion_transfer_error="",this.dialogFormVisible=!1,this.allLoading=!0;var e=this.temp;e.minions=[],this.temp.minion_list.forEach(function(t){e.minions.push(t)}),e.minions=e.minions.join(","),Object(o["A"])(e).then(function(e){e.data.status?(c["Message"].success(e.data.results),t.getListNoloading(),t.allLoading=!1):(c["Message"].error(e.data.results),t.allLoading=!1)}).catch(function(t){console.log("命令采集"+t)})},handleDeleteSaltCmdList:function(){var t=this;this.$confirm("确认要情况?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.allLoading=!0,Object(o["c"])().then(function(e){e.data.status?(c["Message"].success(e.data.results),t.getListNoloading(),t.allLoading=!1):(c["Message"].error(e.data.results),t.allLoading=!1)}).catch(function(t){console.log("清空命令"+t)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleSelectionChange:function(t){this.multipleSelection=t},sortChange:function(t){var e=t.prop,n=t.order;"salt_cmd_type"===e?this.listQuery.ordering="ascending"===n?"salt_cmd_type":"-salt_cmd_type":"salt_cmd"===e&&(this.listQuery.ordering="ascending"===n?"salt_cmd":"-salt_cmd"),this.handleFilter()},handleSaltCmdInfo:function(t){this.infoTemp={},this.infoTemp=Object.assign({},t),this.dialogInfoVisible=!0}}},d=u,m=(n("a483"),n("2877")),f=Object(m["a"])(d,a,i,!1,null,"1d6ed67a",null);e["default"]=f.exports},"8d41":function(t,e,n){},"8e7e":function(t,e,n){},a483:function(t,e,n){"use strict";var a=n("8e7e"),i=n.n(a);i.a}}]);