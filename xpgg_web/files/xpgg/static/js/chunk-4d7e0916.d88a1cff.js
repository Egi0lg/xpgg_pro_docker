(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d7e0916"],{"54a9":function(t,e,i){},"5ec7":function(t,e,i){"use strict";var a=i("54a9"),n=i.n(a);n.a},b081:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.allLoading,expression:"allLoading"}],staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-row",{},[i("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"small"},on:{click:t.handleMultipleDeleteDailog}},[t._v("批量删除")]),t._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"small",loading:t.listLoading},on:{click:t.getList}},[t._v("刷新")]),t._v(" "),i("div",{staticStyle:{float:"right"}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"任务名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.search,callback:function(e){t.$set(t.listQuery,"search",e)},expression:"listQuery.search"}}),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("搜索")])],1)],1)],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.data_list,size:"medium",border:"",fit:"","highlight-current-row":""},on:{"sort-change":t.sortChange,"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{label:"ID",sortable:"custom",prop:"id",align:"center","min-width":"40"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.id))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"任务名称",sortable:"custom",prop:"task_name",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.task_name))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"完成时间",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("parseTime")(e.row.date_done,"{y}-{m}-{d} {h}:{i}")))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"状态",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.status))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.handleTaskLogInfo(e.row)}}},[t._v("结果")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){return t.handleDeleteTaskLog(e)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,page_size:t.listQuery.page_size},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:page_size":function(e){return t.$set(t.listQuery,"page_size",e)},pagination:t.getList}}),t._v(" "),i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{visible:t.dialogInfoVisible,title:t.result_title,width:"40%"},on:{"update:visible":function(e){t.dialogInfoVisible=e}}},[i("pre",{ref:"info_data",staticClass:"taskLog_pre",domProps:{innerHTML:t._s(t.info_data)}}),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogInfoVisible=!1}}},[t._v("确定")])],1)])],1)},n=[],s=(i("6b54"),i("b85c")),l=(i("96cf"),i("1da1")),o=i("5c83"),r=i("b199"),c=i("6724"),d=(i("ed08"),i("333d")),u=i("5c96"),f={name:"TaskLog",components:{Pagination:d["a"]},directives:{elDragDialog:o["a"],waves:c["a"]},data:function(){return{taskLog:{},listQuery:{page:1,page_size:10,ordering:"-id"},allLoading:!1,tableKey:0,data_list:null,total:0,multipleSelection:[],listLoading:!0,info_data:"",result_title:"",dialogInfoVisible:!1}},watch:{},created:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,Object(r["q"])(this.listQuery).then((function(e){t.data_list=e.data.results,t.total=e.data.count,setTimeout((function(){t.listLoading=!1}),500)})).catch((function(e){t.listLoading=!1}))},handleFilter:function(){this.listQuery.page=1,this.getList()},handleSelectionChange:function(t){this.multipleSelection=t},handleDeleteTaskLog:function(t){var e=this,i=t.$index,a=t.row;this.$confirm("确认要删除该记录吗?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.prev=1,t.next=4,Object(r["i"])(a.id);case 4:e.$message({type:"success",message:"删除成功!"}),e.data_list.splice(i,1),e.getList(),t.next=14;break;case 9:t.prev=9,t.t0=t["catch"](1),e.listLoading=!1,console.log("删除记录"+t.t0),e.$message({type:"info",message:"删除记录"+t.t0});case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))).catch((function(){e.$message({type:"info",message:"取消"})}))},handleMultipleDeleteDailog:function(){var t=this;if(0===this.multipleSelection.length)u["Message"].error("未选择任何记录，请选择");else{var e,i=[],a=Object(s["a"])(this.multipleSelection);try{for(a.s();!(e=a.n()).done;){var n=e.value;i.push(n.id)}}catch(o){a.e(o)}finally{a.f()}var l={};l.id_list=i,console.log(l),Object(r["r"])(l).then((function(e){if(e.data.status)u["Message"].success(e.data.results),t.getList();else{var i=e.data.results;console.log(JSON.stringify(i)),u["Message"].error(JSON.stringify(i))}})).catch((function(t){}))}},sortChange:function(t){var e=t.prop,i=t.order;"id"===e?this.listQuery.ordering="ascending"===i?"id":"-id":"task_name"===e&&(this.listQuery.ordering="ascending"===i?"task_name":"-task_name"),this.handleFilter()},info_fun:function(t,e){if(t)for(var i in t){var a=t[i];"[object Object]"===Object.prototype.toString.call(a)||"[object Array]"===Object.prototype.toString.call(a)?(this.info_data=this.info_data+"<p style='color: #3FB8AF;padding-left: "+25*e+"px;'>"+i+":</p>",this.info_fun(a,e+1)):(this.info_data=this.info_data+"<p style='color: #3FB8AF;padding-left: "+25*e+"px;'>"+i+":</p>",this.info_data=this.info_data+"<p style='padding-left: "+25*(e+1)+"px;'>"+a+"</p>")}},handleTaskLogInfo:function(t){if(this.result_title=t.task_name,this.info_data="","[object String]"!==Object.prototype.toString.call(JSON.parse(t.result))){var e=0,i=JSON.parse(t.result);for(var a in i){var n=i[a];"[object Object]"===Object.prototype.toString.call(n)?(this.info_data=this.info_data+"<p style='color: #45ddd4;font-weight: bold;'>"+a+":</p>",this.info_fun(n,e+1)):"[object Array]"===Object.prototype.toString.call(n)?(this.info_data=this.info_data+"<p style='color: #45ddd4;font-weight: bold;'>"+a+":</p>",this.info_fun(n,e+1),this.info_data=this.info_data+"\n\n"):(this.info_data=this.info_data+"<p style='color: #3FB8AF;font-weight: bold;'>"+a+":</p>",this.info_data=this.info_data+"<p style='padding-left: 25px;'>"+n+"</p>",this.info_data=this.info_data+"\n\n")}}else this.info_data="",this.info_data=this.info_data+"<p style='color: #bf0000;'>"+JSON.parse(t.result)+"</p>";this.dialogInfoVisible=!0}}},p=f,g=(i("5ec7"),i("2877")),h=Object(g["a"])(p,a,n,!1,null,"0f0e4181",null);e["default"]=h.exports}}]);